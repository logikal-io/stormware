name: Test pull request
on: pull_request

jobs:
  run-python-tests:
    name: Run Python tests
    uses: logikal-io/github-workflows/.github/workflows/python-run-tests.yml@v11
    with:
      pytest-args: -m "integration or not integration"
      aws-testing-role: arn:aws:iam::979401941518:role/testing-stormware-logikal-io
      aws-testing-region: eu-central-2
      gcp-testing-workload-identity-provider: "projects/535697707941/locations/global/\
                                               workloadIdentityPools/ci-cd/providers/\
                                               github-actions"
      gcp-testing-service-account: testing@stormware-logikal-io.iam.gserviceaccount.com
    permissions:
      contents: read
      id-token: write

  run-terraform-tests:
    name: Run Terraform tests
    uses: logikal-io/github-workflows/.github/workflows/terraform-run-tests.yml@v11
